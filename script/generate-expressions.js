var fs = require('fs')
var path = require('path')
var regenerate = require('regenerate')
var characters = require('../lib/util/characters')

var ws = regenerate()
  .add(
    characters.tab,
    characters.lineFeed,
    characters.formFeed,
    characters.carriageReturn
  )
  .add(unicode('Space_Separator'))
  .toRegExp()

var pcAll = regenerate()
  .addRange(characters.exclamationMark, characters.slash)
  .addRange(characters.colon, characters.atSign)
  .addRange(characters.leftSquareBracket, characters.graveAccent)
  .addRange(characters.leftCurlyBrace, characters.tilde)
  .add(unicode('Connector_Punctuation'))
  .add(unicode('Dash_Punctuation'))
  .add(unicode('Close_Punctuation'))
  .add(unicode('Final_Punctuation'))
  .add(unicode('Initial_Punctuation'))
  .add(unicode('Other_Punctuation'))
  .add(unicode('Open_Punctuation'))
  .valueOf()

// To do: support astrals as well.
var pc = regenerate()
  // Ignore non-BMP characters.
  .add(pcAll.filter((d) => d <= 0xffff))
  .toRegExp()

fs.writeFileSync(
  path.join('lib', 'character', 'group', 'unicode-whitespace-regex.js'),
  '// This module is generated by `script/`.\nmodule.exports = ' + ws + '\n'
)

fs.writeFileSync(
  path.join('lib', 'character', 'group', 'unicode-punctuation-regex.js'),
  '// This module is generated by `script/`.\nmodule.exports = ' + pc + '\n'
)

function unicode(d) {
  return require('unicode-13.0.0/General_Category/' + d + '/code-points')
}
